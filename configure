#!/bin/bash

# This script will be used to configure the build environment

rm -f Makefile settings.mk settings.sh
ln -s Makefile.linux Makefile
touch settings.mk settings.sh
chmod a+x settings.sh

BITS=32
if [ x`uname -m` == x"x86_64" ] ; then
    BITS=64
fi
echo BITS=$BITS >> settings.mk
echo export BITS=$BITS >> settings.sh

if [ x`which ccache`x != x"" ] ; then
    if [[ x`which distcc` != x"" ]] ; then
        echo CC="ccache distcc gcc"           >> settings.mk
        echo CXX="ccache distcc g++"          >> settings.mk
        echo export CC=\"ccache distcc gcc\"  >> settings.sh
        echo export CXX=\"ccache distcc g++\" >> settings.sh
    else
        echo CC="ccache gcc"           >> settings.mk
        echo CXX="ccache g++"          >> settings.mk
        echo export CC=\"ccache gcc\"  >> settings.sh
        echo export CXX=\"ccache g++\" >> settings.sh
    fi
fi

echo CCACHE_DIR=`echo ~`/.ccache        >> settings.mk
echo CCACHE_UMASK=002                   >> settings.mk
echo DISTCC_DIR=`echo ~`/.distcc        >> settings.mk
echo export CCACHE_DIR=`echo ~`/.ccache >> settings.sh
echo export CCACHE_UMASK=002            >> settings.sh
echo export DISTCC_DIR=`echo ~`/.distcc >> settings.sh
